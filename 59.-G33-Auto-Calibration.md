# About auto-calibration (G33) and bed mapping (G29)
_Author: Luc Van Daele_

Some confusion exists to differentiate between those. On Cartesian printers bed calibration consists only of adjusting the bed to be horizontally to the X and Y carriages. With G29 this can be done in two ways: 3 point calibration and detailed bed probing. Both do calculate the plane of the bed (defined by 3 points or least square method on a grid of points) and adjust in software for any differences. This is auto bed leveling.

Furthermore detailed probing also has the functionality of eliminating little bumps and dips in the bed by interpolating between the probe-grid and making small adjustments to the z-height. This is called detailed bed mapping. Both are done at the same time with G29 on Cartesian printers.

However on a delta-printer these are two completely different things. The bed is fixed to the frame on a delta so it can not be set parallel to X and Y carriages (which do not even exist on a delta compared to a cartesian). Therefore on a delta only the detailed bed probing and bed mapping functions are maintained in G29. G29 does not do any calibration on deltas.

Calibrating a delta printer is done by: 
1) Setting the delta-height so the nozzle is at print height when at coordinate Z=0; 
2) Adjusting the end-stops so the triangle of the three carriages when homed is parallel to the bed; 
3) Adjusting the delta radius in order to eliminate that the bed is seen as domed or bowl-shaped. 
Further calibration can be done by adding tower adjustments to compensate for the triangle of the carriages not being perfectly equidistant.

Calibrating a delta printer is more difficult because there are more parameters to adjust and all of them are interconnected. If you change one, this influences all the others. And the relationships are not linear as with Cartesian printers. Therefore an iteration process is required by checking the calibration points, adjusting the parameters, rechecking the probe-points, readjusting the parameters, and so on. This is time consuming and these iterations can be automated. This process has been put in a new command G33.

Beware to turn off the auto-bed-level G29 when probing in order to manually calibrate a printer; with bed-mapping on you do not have a clue what the true probe heights are, so you can't calibrate correctly. And of course if you calibrate with bed mapping turned on, once you turn off the printer the bed-map data is lost and the calibration is off. 

# Usage

* G33 - Delta auto calibration of height ('1 point') + end-stops, delta radius ('4 point') + tower angle corrections ('7+ point')
* G33 (Cn) (Vn)
* Cn = calibrate number of probe points (n*n) (-2 , 1-4)
* Vn = verbose level (0-2)
Changed command:
* M665: Set delta configurations
* M665 (Hx.x) (Lx.x) (Rx.x) (Bx.x) (Sn) (Xx.x) (Yx.x) (Zx.x)

* H = delta height
* L = diagonal rod
* R = delta radius
* B = radius for calibration points
* S = segments per second
* X = corr. for angle between towers Y and Z (*)
* Y = corr. for angle between towers Z and X (*)
* Z = corr. for angle between towers X and Y (*) (auto adjusted so sum of corrected angles = 360.0)
* (*) measured in degrees : positive -> angle larger than 120° by x.x; negative -> angle smaler than 120° by -x.x

# G33 and how to interpret the numbers?
_Author: Maxim Riabichev_

### Example printout:  
Iteration : 01 std dev:0.020  
.Height:307.90 Ex:+0.00 Ey:-0.01 Ez:-0.02 Radius:99.31  
.Tower angle : YZ:+1.04 ZX:-0.62 [XY:-0.42]  

#### std dev:0.020 = A measure of quality of your printer.
Aim for values of at least 0.03. The lower, the better.

#### Height: 307.90 = Max Z-height after calibration.  
When std dev is at 0.03 or below, put this value into Marlin configuration.h file.

#### Ex:+0.00 Ey:-0.01 Ez:-0.02 = End-stop relationship after calibration. 
You can and should adjust respective axis' end-stop according to the end-stop values acquired from the calibration.  
If you get, for example: "Ex:+0.00 Ey:-0.41 Ez:-0.98" then you can either tighten the X-carriage end-stop screw, or you can unscrew the Y and Z screws. 1 full turn of screw is approximately 0.5 mm. The aim is to get them all within 0.03 mm of one another.  
Do note that the next calibration might give you a lower standard deviation and slightly different end-stop values. The standard deviation value is your guiding light, adjust end-stops after the lowest std dev value.  
When your std dev is <0.04 and your end-stops are <0.04 mm from each other, you can stop running G33. Instead, enter the end-stop values into your firmware like so:  
#define DELTA_ENDSTOP_ADJ { -0.00, -0.01, -0.02 } (Values here based on values from the example print out above.)
 
#### Radius: 99.31 = Delta Radius after calibration.  
When std dev is at 0.03 or below, put this value into Marlin configuration.h file.

#### Tower angle : YZ:+1.04 ZX:-0.62 [XY:-0.42] = The angle between respective tower over or under 120 degrees.  
When std dev is at 0.03 or below, put these values into Marlin configuration.h file.

# Is something not working?
Check the Troubleshooting section of this wiki.